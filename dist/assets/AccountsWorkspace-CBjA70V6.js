import{c as g,a as d,j as e,L as f,X as w}from"./index-BfYDDugh.js";import{u as j,g as k,P as y}from"./platforms-Mh9qq0aw.js";import{R as C}from"./refresh-cw-CLBNPLXA.js";import{T as A}from"./trash-2-DY0QlhK9.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],I=g("CircleCheck",S);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],_=g("CircleX",P);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],v=g("ExternalLink",L);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],N=g("Plus",R);function M({account:t}){const{removeAccount:m,testConnection:n,refreshPublications:i}=j(),r=k(t.platform),[o,l]=d.useState(!1),[x,u]=d.useState(!1),h=async()=>{l(!0),await n(t.platform,t.accountId),await i(t.platform,t.accountId),l(!1)},a=async()=>{u(!0),await m(t.platform,t.accountId)};return e.jsx("div",{className:"rounded-xl border border-border bg-card p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold text-sm shrink-0",style:{backgroundColor:(r==null?void 0:r.color)||"#666"},children:(r==null?void 0:r.name[0])||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:t.accountName||"Unnamed Account"}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-muted text-muted-foreground",children:(r==null?void 0:r.name)||t.platform}),t.isConnected?e.jsx(I,{className:"w-3.5 h-3.5 text-green-500"}):e.jsx(_,{className:"w-3.5 h-3.5 text-muted-foreground"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t.email}),t.publications.length>0&&e.jsx("div",{className:"mt-3 space-y-1.5",children:t.publications.map(c=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:c.name}),c.subscriberCount!==null&&e.jsxs("span",{children:["· ",c.subscriberCount.toLocaleString()," subscribers"]}),c.url&&e.jsx("a",{href:c.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary",children:e.jsx(v,{className:"w-3 h-3"})})]},c.id))}),t.platform==="substack"&&e.jsx("p",{className:"text-[11px] text-yellow-500/80 mt-2",children:"⚠️ Substack has no official API. Some features may be limited or stop working."})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:h,disabled:o,className:"h-8 w-8 rounded-md flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-muted transition-colors",title:"Test connection",children:o?e.jsx(f,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(C,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:a,disabled:x,className:"h-8 w-8 rounded-md flex items-center justify-center text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors",title:"Remove account",children:x?e.jsx(f,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(A,{className:"w-3.5 h-3.5"})})]})]})})}function T({onClose:t}){const{addAccount:m}=j(),[n,i]=d.useState(null),[r,o]=d.useState({}),[l,x]=d.useState(!1),[u,h]=d.useState(null),a=y.find(s=>s.id===n),c=async()=>{if(n){x(!0),h(null);try{await m(n,r),t()}catch(s){h(String(s))}finally{x(!1)}}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),e.jsxs("div",{className:"relative w-full max-w-md bg-popover border border-border rounded-xl shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h2",{className:"text-sm font-semibold text-foreground",children:n?`Connect ${a==null?void 0:a.name}`:"Add Account"}),e.jsx("button",{onClick:t,className:"h-6 w-6 rounded flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-muted",children:e.jsx(w,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"p-4",children:n?e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>i(null),className:"text-xs text-muted-foreground hover:text-foreground mb-2",children:"← Back to platforms"}),a==null?void 0:a.fields.map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:s.label}),s.type==="textarea"?e.jsx("textarea",{value:r[s.key]||"",onChange:p=>o(b=>({...b,[s.key]:p.target.value})),placeholder:s.placeholder,rows:3,className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground/50 outline-none focus:ring-1 focus:ring-ring resize-none"}):e.jsx("input",{type:s.type,value:r[s.key]||"",onChange:p=>o(b=>({...b,[s.key]:p.target.value})),placeholder:s.placeholder,className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground/50 outline-none focus:ring-1 focus:ring-ring"})]},s.key)),a&&e.jsxs("a",{href:a.apiDocsUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-xs text-primary hover:underline",children:[e.jsx(v,{className:"w-3 h-3"}),"Where do I find my API key?"]}),u&&e.jsx("p",{className:"text-xs text-destructive",children:u}),e.jsxs("button",{onClick:c,disabled:l,className:"w-full h-9 rounded-md bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[l&&e.jsx(f,{className:"w-3.5 h-3.5 animate-spin"}),"Connect Account"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Choose a newsletter platform to connect:"}),y.map(s=>e.jsxs("button",{onClick:()=>{i(s.id),o({})},className:"flex items-center gap-3 w-full p-3 rounded-lg border border-border hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center text-white font-bold text-xs",style:{backgroundColor:s.color},children:s.name[0]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]}),!s.hasOfficialApi&&e.jsx("span",{className:"text-[10px] text-yellow-500 bg-yellow-500/10 px-1.5 py-0.5 rounded",children:"Unofficial"})]},s.id))]})})]})]})}function D(){const{accounts:t,isLoading:m,error:n,loadAccounts:i}=j(),[r,o]=d.useState(!1);return d.useEffect(()=>{i()},[i]),e.jsxs("div",{className:"h-full overflow-y-auto",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-foreground",children:"Accounts"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your newsletter platform connections"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Add Account"]})]}),n&&e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-destructive/10 border border-destructive/20 text-sm text-destructive",children:n}),m&&t.length===0&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(f,{className:"w-5 h-5 animate-spin text-muted-foreground"})}),!m&&t.length===0&&e.jsxs("div",{className:"text-center py-20 border border-dashed border-border rounded-xl",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-muted flex items-center justify-center mx-auto mb-4",children:e.jsx(N,{className:"w-5 h-5 text-muted-foreground"})}),e.jsx("h3",{className:"text-sm font-medium text-foreground mb-1",children:"No accounts connected"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Connect your Beehiiv, Substack, or Kit account to start publishing"}),e.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 rounded-lg bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors",children:"Add Your First Account"})]}),e.jsx("div",{className:"space-y-4",children:t.map(l=>e.jsx(M,{account:l},`${l.platform}-${l.accountId}`))})]}),r&&e.jsx(T,{onClose:()=>o(!1)})]})}export{D as default};
